{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"The Mountain Peaks API Documentation V1","text":"<p>This documentation provides a comprehensive guide to the Peaks API project, a simple web service for storing and retrieving mountain peaks data.</p>"},{"location":"#table-of-contents","title":"Table of Contents","text":"<ul> <li>Home</li> <li>Try Out Now</li> <li>API Reference</li> <li>Database</li> <li>Configuration</li> <li>CI/CD</li> <li>Security</li> </ul>"},{"location":"#home","title":"Home","text":"<p>This documentation is accessible online, here. The API is currently running in a development environment.</p> <ol> <li>Open the web page of the documentation.</li> <li>Click on Try Out Now in the summary to authenticate.</li> <li>Land on the list of all peaks that are currently stored in the database.</li> </ol> <p>Welcome to the Mountain Peaks API documentation. This API allows you to manage mountain peak data, including creating, reading, updating, and deleting peak records, as well as retrieving peaks within a specified geographical bounding box.</p> <p>This project is built using:</p> <ul> <li>FastAPI: For the asynchronous REST API.</li> <li>SQLAlchemy: For database interaction.</li> <li>Alembic: For database migrations.</li> <li>PostgreSQL: As the database backend.</li> <li>Docker &amp; Docker Compose: For containerization and deployment.</li> <li>GitHub Actions: For continuous integration and deployment.</li> <li>MkDocs: For the web documentation.</li> </ul>"},{"location":"#try-it-out","title":"Try it out","text":"<p>Connect to try it out online. Click HERE</p>"},{"location":"#prerequisites","title":"Prerequisites","text":"<ul> <li>Python &gt; 3.11</li> <li>Docker and Docker Compose installed.</li> <li>Postman or <code>curl</code> for testing API endpoints.</li> </ul>"},{"location":"#running-the-api","title":"Running the API","text":"<ol> <li> <p>Clone the repository:</p> <p><code>bash git clone [https://github.com/nojoven/peaks.git](https://github.com/nojoven/peaks.git) cd peaks</code></p> </li> <li> <p>Complete the <code>.env</code> file with the required environment variables.</p> </li> <li> <p>Start the containers:</p> <p><code>bash docker-compose up --build</code></p> </li> <li> <p>The API will be available at <code>http://localhost:8000</code>.</p> </li> </ol>"},{"location":"#example-requests","title":"Example Requests","text":"<ul> <li> <p>Create a Peak:</p> <p><code>bash curl -X POST -H \"Content-Type: application/json\" -d '{   \"name\": \"Mont Blanc\",   \"latitude\": 45.8326,   \"longitude\": 6.8652,   \"altitude\": 4808.73 }' http://localhost:8000/peaks/create</code></p> </li> <li> <p>Get a Peak:</p> <p><code>bash curl http://localhost:8000/peaks/peak/1</code></p> </li> <li> <p>Get Peaks within a bounding box:</p> <p><code>bash curl http://localhost:8000/peaks/?min_lat=44.5&amp;max_lat=46.5&amp;min_lon=5.5&amp;max_lon=7.5</code></p> </li> </ul>"},{"location":"#to-be-added","title":"To be added","text":"<ul> <li>Authentication and authorization.</li> <li>Input validation and error handling.</li> <li>Detailed error messages.</li> <li>Secret management.</li> <li>Web interface.</li> <li>More comprehensive documentation.</li> <li>Add more tests.</li> <li>Add security measures.</li> </ul>"},{"location":"#unit-tests","title":"Unit tests","text":"<p>We use pytest for unit testing. If you want to run the tests locally, you can use the following command:</p> <pre><code>pytest --cov=src --cov-report=term-missing tests/ -v\n</code></pre> <p>You will need a python virtual environment to do so:</p> <ol> <li> <p>At the root of the project, run:</p> <p><code>bash python -m venv .venv</code></p> </li> <li> <p>Activate the virtual environment:</p> <p><code>bash source .venv/bin/activate # or .venv\\Scripts\\activate on Windows</code></p> </li> <li> <p>Install the dependencies:</p> <p><code>bash pip install -r requirements.txt</code></p> </li> <li> <p>Run the tests:</p> <p><code>bash pytest --cov=src --cov-report=term-missing tests/ -v</code></p> </li> </ol>"},{"location":"#mkdocs-local-documentation-in-your-browser","title":"MkDocs local documentation in your browser","text":"<p>You will need an activated python virtual environment as well. Please see the previous section. Then, follow these steps:</p> <ol> <li> <p>At the root of the project, run:</p> <p><code>bash mkdocs build -f docs/mkdocs.yml --clean</code></p> </li> <li> <p>Run</p> <p><code>bash mkdocs serve</code></p> </li> </ol>"},{"location":"#follow-us-on-github","title":"Follow us on GitHub","text":""},{"location":"api_reference/","title":"API Reference","text":"<p>This section documents the API endpoints and their parameters, reflecting the current implementation using FastAPI and SQLModel.</p>"},{"location":"api_reference/#authentication","title":"Authentication","text":""},{"location":"api_reference/#api-key-authentication","title":"API Key Authentication","text":"<p>Contact the administrator to obtain an API key.</p>"},{"location":"api_reference/#oauth-authentication-with-github","title":"OAuth Authentication with GitHub","text":"<p>Contact the administrator to obtain the OAuth client ID and secret as well as the required URLs.</p> <p>The present router is prefixed with \"auth/\" so the endpoints are only accessible at \"auth/endpoint\". The callback endpoint is \"auth/auth\".</p>"},{"location":"api_reference/#endpoints","title":"Endpoints","text":""},{"location":"api_reference/#important","title":"IMPORTANT","text":"<p>The HTTP responses status codes need to be reviewed and updated. Server errors should be 5xx, not 4xx. We will improve this later</p>"},{"location":"api_reference/#peaks","title":"Peaks","text":"<ul> <li><code>GET /peaks/peak/{peak_id}</code>: Retrieve a peak by its ID.</li> <li>Parameters:<ul> <li><code>peak_id</code> (path parameter): Integer, the ID of the peak to retrieve.</li> </ul> </li> <li>Response:<ul> <li>Returns a JSON representation of the <code>Peak</code> object.</li> <li>Returns a 404 error if the peak is not found.</li> </ul> </li> <li> <p>Example: <code>GET /peaks/peak/1</code></p> </li> <li> <p><code>POST /peaks/peak/create</code>: Create a new peak.</p> </li> <li>Request Body:<ul> <li>JSON representation of the <code>Peak</code> object (name, latitude, longitude, altitude).</li> </ul> </li> <li>Response:<ul> <li>Returns a JSON representation of the created <code>Peak</code> object.</li> <li>Returns a 201 status code upon successful creation.</li> <li>Returns a 400 error if there is an issue with the creation.</li> </ul> </li> <li> <p>Example: <code>POST /peaks/peak/create</code> with JSON payload.</p> </li> <li> <p><code>POST /peaks/create</code>: Bulk create peaks from a list.</p> </li> <li>Request Body:<ul> <li>JSON array of <code>Peak</code> objects.</li> </ul> </li> <li>Response:<ul> <li>Returns a 201 status code upon successful creation.</li> <li>Returns a 400 error if there is an issue with the bulk creation.</li> </ul> </li> <li> <p>Example: <code>POST /peaks/create</code> with JSON array payload.</p> </li> <li> <p><code>PUT /peaks/peak/{peak_id}</code>: Update a peak by its ID.</p> </li> <li>Parameters:<ul> <li><code>peak_id</code> (path parameter): Integer, the ID of the peak to update.</li> </ul> </li> <li>Request Body:<ul> <li>JSON representation of the <code>Peak</code> object with updated fields.</li> </ul> </li> <li>Response:<ul> <li>Returns a 200 status code upon successful update.</li> <li>Returns a 404 error if the peak is not found.</li> </ul> </li> <li> <p>Example: <code>PUT /peaks/peak/1</code> with JSON payload.</p> </li> <li> <p><code>DELETE /peaks/peak/{peak_id}</code>: Delete a peak by its ID.</p> </li> <li>Parameters:<ul> <li><code>peak_id</code> (path parameter): Integer, the ID of the peak to delete.</li> </ul> </li> <li>Response:<ul> <li>Returns a 204 status code upon successful deletion.</li> <li>Returns a 404 error if the peak is not found.</li> </ul> </li> <li> <p>Example: <code>DELETE /peaks/peak/1</code></p> </li> <li> <p><code>GET /peaks/boundingbox</code>: Retrieve peaks within a given geographical bounding box.</p> </li> <li>Query Parameters:<ul> <li><code>min_lat</code> (float): Minimum latitude.</li> <li><code>max_lat</code> (float): Maximum latitude.</li> <li><code>min_lon</code> (float): Minimum longitude.</li> <li><code>max_lon</code> (float): Maximum longitude.</li> </ul> </li> <li>Response:<ul> <li>Returns a JSON array of <code>Peak</code> objects within the bounding box.</li> <li>Returns a 404 error if no peaks are found.</li> </ul> </li> <li>Example: <code>GET /peaks/boundingbox?min_lat=44.5&amp;max_lat=46.5&amp;min_lon=5.5&amp;max_lon=7.5</code></li> </ul>"},{"location":"api_reference/#data-models","title":"Data Models","text":"<ul> <li>Peak:</li> <li><code>id</code>: Integer (auto-incrementing)</li> <li><code>name</code>: String</li> <li><code>lat</code>: Float</li> <li><code>lon</code>: Float</li> <li><code>altitude</code>: Float</li> </ul>"},{"location":"api_reference/#dependencies","title":"Dependencies","text":"<ul> <li><code>db: Session = Depends(get_db)</code>: Injects a database session into each endpoint.</li> </ul>"},{"location":"api_reference/#error-handling","title":"Error Handling","text":"<ul> <li>Endpoints raise <code>HTTPException</code> with appropriate status codes (404, 400) and error details when necessary.</li> <li>Database transactions are rolled back in case of errors to maintain data integrity.</li> </ul>"},{"location":"ci_cd/","title":"CI/CD","text":"<p>GitHub Actions is used for continuous integration and deployment.</p>"},{"location":"ci_cd/#github-actions-workflow","title":"GitHub Actions Workflow","text":"<ul> <li>Builds Docker images for test and production environments.</li> <li>Runs unit tests with coverage reporting (commented because of error 137 -not enough memory).</li> </ul>"},{"location":"ci_cd/#branches","title":"Branches","text":"<ul> <li><code>main</code>: Main branch, protected by default.</li> <li><code>develop</code>: Development branch, protected by default.</li> </ul>"},{"location":"ci_cd/#environments","title":"Environments","text":"<ul> <li><code>dev</code>: Development environment.</li> <li><code>prod</code>: Production environment. The main branch will be deployed there.</li> </ul>"},{"location":"ci_cd/#web-deployment","title":"Web deployment","text":"<p>We use Render for web deployment. For the moment, the production environment is not set up. You can try it out the development environment here.</p>"},{"location":"configuration/","title":"Configuration","text":""},{"location":"configuration/#dockerfile","title":"Dockerfile","text":"<p>The Dockerfile is used to build the API container.</p>"},{"location":"configuration/#docker-compose","title":"Docker Compose","text":"<p>The docker-compose.yml file is used to define and run multi-container Docker applications.</p>"},{"location":"configuration/#github-actions","title":"GitHub Actions","text":"<p>The .github/workflows/docker-compose-ci.yml file is used to define the CI/CD workflow.</p>"},{"location":"configuration/#env","title":".env","text":"<p>We use a simple .env file to store the environment variables.</p>"},{"location":"configuration/#database","title":"Database","text":"<p>POSTGRES_USER POSTGRES_PASSWORD DATABASE_ENGINE DATABASE_ADDRESS DATABASE_NAME DATABASE_PORT</p>"},{"location":"configuration/#oauth","title":"OAuth","text":"<p>OAUTH_GITHUB_CLIENT_ID OAUTH_GITHUB_CLIENT_SECRET OAUTH_GITHUB_ACCESS_TOKEN_URL OAUTH_GITHUB_AUTHORIZE_URL OAUTH_GITHUB_API_BASE_URL</p>"},{"location":"configuration/#api","title":"API","text":"<p>PEAK_API_SECRET_KEY MANAGER_API_KEY</p>"},{"location":"configuration/#docker","title":"Docker","text":"<p>DOCKER_COMPOSE_DATABASE_PORT</p>"},{"location":"configuration/#production","title":"Production","text":"<p>PRODUCTION = TRUE  or FALSE (default: FALSE)</p>"},{"location":"configuration/#sentry","title":"Sentry","text":"<p>SENTRY_DSN : URL of your Sentry project</p>"},{"location":"database/","title":"Database","text":"<p>The API uses a PostgreSQL database to store peak data.</p>"},{"location":"database/#database-schema","title":"Database Schema","text":"<ul> <li><code>peaks</code> table:</li> <li><code>id</code> (SERIAL PRIMARY KEY)</li> <li><code>name</code> (VARCHAR)</li> <li><code>latitude</code> (FLOAT)</li> <li><code>longitude</code> (FLOAT)</li> <li><code>altitude</code> (FLOAT)</li> </ul>"},{"location":"database/#database-migrations","title":"Database Migrations","text":"<p>Alembic is used for database migrations.</p>"},{"location":"database/#environment-variables","title":"Environment Variables","text":"<ul> <li><code>DATABASE_URL</code>: PostgreSQL database connection URL. It must start with <code>postgresql+psycopg://</code> because we use the <code>psycopg 3</code> driver.</li> </ul>"},{"location":"security/","title":"Security","text":"<p>Currently, the API does not implement security measures. This section will be updated with information on securing the API.</p>"}]}